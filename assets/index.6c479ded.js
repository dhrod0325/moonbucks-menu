var w=Object.defineProperty,I=Object.defineProperties;var L=Object.getOwnPropertyDescriptors;var O=Object.getOwnPropertySymbols;var T=Object.prototype.hasOwnProperty,R=Object.prototype.propertyIsEnumerable;var _=(e,t,o)=>t in e?w(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,b=(e,t)=>{for(var o in t||(t={}))T.call(t,o)&&_(e,o,t[o]);if(O)for(var o of O(t))R.call(t,o)&&_(e,o,t[o]);return e},A=(e,t)=>I(e,L(t));const S=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const u of n)if(u.type==="childList")for(const s of u.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function o(n){const u={};return n.integrity&&(u.integrity=n.integrity),n.referrerpolicy&&(u.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?u.credentials="include":n.crossorigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function r(n){if(n.ep)return;n.ep=!0;const u=o(n);fetch(n.href,u)}};S();const h=Object.freeze({PROMPT_MENU_NAME:"\uC774\uB984\uC744 \uC785\uB825\uD558\uC138\uC694",REQUIRED_MENU_NAME:"\uBA54\uB274 \uC774\uB984\uC744 \uC785\uB825\uD558\uC138\uC694",CONFIRM_DELETE:"\uC815\uB9D0\uB85C \uC0AD\uC81C\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?"}),f=Object.freeze({ADD_MENU:"ADD_MENU",REMOVE_MENU:"REMOVE_MENU",MENU_FORM_SUBMIT:"MENU_FORM_SUBMIT",CHANGE_MENU:"CHANGE_MENU",CHANGE_CATEGORY:"CHANGE_CATEGORY"});function N(e,t=document){return t.querySelector(e)}function D(e,t=document){return t.querySelectorAll(e)}function G(e){const t=document.createElement("template");return t.insertAdjacentHTML("afterbegin",e),t.firstElementChild.cloneNode(!0)}function g(e,t,o=window){o.dispatchEvent(new CustomEvent(e,{detail:t}))}function M(e,t,o=window){o.addEventListener(e,({detail:r})=>t(r))}function v(e){if(!(e||"").trim())throw new Error(h.REQUIRED_MENU_NAME)}async function j({api:e}){const t={espresso:{name:"\u2615 \uC5D0\uC2A4\uD504\uB808\uC18C",items:[]},frappuccino:{name:"\u{1F964} \uD504\uB77C\uD478\uCE58\uB178",items:[]},blended:{name:"\u{1F379} \uBE14\uB80C\uB514\uB4DC",items:[]},teavana:{name:"\u{1FAD6} \uD2F0\uBC14\uB098",items:[]},desert:{name:"\u{1F370} \uB514\uC800\uD2B8",items:[]}};return Object.keys(t).forEach(async o=>{const r=await e.getMenu({categoryName:o});t[o].items=r.map(n=>{const{id:u,name:s,isSoldOut:a}=n;return A(b({},n),{menuName:s,menuId:u,soldout:a})})}),t}function B(e){function t(){return e.currentCafe}function o(){return e.cafe[e.currentCafe]}function r(){return o().name}function n(){return o().items}function u(){return n().length}function s(d){o().items=d}function a(d){s([...n(),d])}function l(d){s(n().filter(y=>y.menuId!==d))}function c({menuId:d,menuName:y,soldout:p}){const m=i(d);m.menuName=y,m.soldout=p}function i(d){return n().find(y=>y.menuId===d)}function E(d){e.currentCafe=d}return{currentCafe:o,currentCafeName:r,setCurrentCafe:E,currentCafeItems:n,currentCafeItemsSize:u,currentCategory:t,getMenuById:i,addMenu:a,editMenu:c,removeMenu:l}}function H({stateManager:e,api:t}){function o(u){const{menuId:s}=u,a=e.getMenuById(s),l=Object.assign(a,u);e.editMenu(l),t.editMenu({menuId:s,name:l.menuName,categoryName:e.currentCategory()})}function r(u){e.addMenu(u)}function n({menuId:u}){e.removeMenu(u),t.delMenu({categoryName:e.currentCategory(),menuId:u})}M(f.CHANGE_MENU,o),M(f.ADD_MENU,r),M(f.REMOVE_MENU,n)}function $(){const e={mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json"}};async function t(u,s){return(await fetch(u,Object.assign(e,s,{method:"GET"}))).json()}async function o(u,s={}){return(await fetch(u,Object.assign(e,{body:JSON.stringify(s)},{method:"POST"}))).json()}async function r(u,s={}){return(await fetch(u,Object.assign(e,{body:JSON.stringify(s)},{method:"PUT"}))).json()}async function n(u,s={}){return await fetch(u,Object.assign(e,{body:JSON.stringify(s)},{method:"DELETE"}))}return{get:t,post:o,put:r,del:n}}function x(e){const t="http://localhost:4000/api",o=(c,i="")=>`${t}/category/${c}/menu${i}`;function r(c){if(c.message)throw new Error(c.message);return c}async function n({categoryName:c,name:i}){const E=o(c);return r(await e.post(E,{name:i}))}async function u({categoryName:c}){const i=o(c);return r(await e.get(i,{name}))}async function s({categoryName:c,menuId:i,name:E}){const d=o(c,`/${i}`);return r(await e.put(d,{name:E}))}async function a({categoryName:c,menuId:i}){const E=o(c,`/${i}/soldout`);return r(await e.put(E))}async function l({categoryName:c,menuId:i}){const E=o(c,`/${i}`);return r(await e.del(E))}return{createMenu:n,getMenu:u,editMenu:s,soldOut:a,delMenu:l}}function F(e){e.addEventListener("submit",t=>{t.preventDefault(),g(f.MENU_FORM_SUBMIT)})}function P(e,{api:t,stateManager:o}){function r(s){e.value=s}function n(){e.focus()}async function u(){const{value:s}=e;try{v(s)}catch(a){return alert(a.message)}r(""),n(),t.createMenu({categoryName:o.currentCategory(),name:s}).then(({id:a})=>{const l=a;g(f.ADD_MENU,{menuId:l,menuName:s})}).catch(a=>alert(a.message))}addEventListener("load",n),M(f.MENU_FORM_SUBMIT,u)}function k(e,{stateManager:t}){function o(n){e.textContent=`\uCD1D ${n}\uAC1C`}function r(){setTimeout(()=>o(t.currentCafeItemsSize()))}M(f.CHANGE_CATEGORY,r),M(f.ADD_MENU,r),M(f.REMOVE_MENU,r)}function V(e,{menuName:t,soldout:o,api:r,stateManager:n}){const u={menuName:t},s=N(".menu-name",e);N(".menu-remove-button",e).addEventListener("click",E),N(".menu-edit-button",e).addEventListener("click",y),N(".menu-soldout-button",e).addEventListener("click",d);function i(m){u.menuName=m,s.textContent=m}function E(){if(!confirm(h.CONFIRM_DELETE))return;const{menuId:m}=e.dataset;e.remove(),g(f.REMOVE_MENU,{menuId:m})}function d(){const{menuId:m,soldout:C}=e.dataset;p(C==="true"?"false":"true"),r.soldOut({categoryName:n.currentCategory(),menuId:m})}function y(){const m=prompt(h.PROMPT_MENU_NAME,u.menuName);try{v(m)}catch{return}i(m);const{menuId:C}=e.dataset;g(f.CHANGE_MENU,{menuId:C,menuName:m})}function p(m){const C="sold-out";`${m}`=="true"?s.classList.add(C):s.classList.remove(C),e.dataset.soldout=m}return p(o),{$container:e}}function Y({menuName:e,soldout:t,api:o,stateManager:r}){const n=`
  <li class="menu-list-item d-flex items-center py-2">
    <span class="w-100 pl-2 menu-name">${e}</span>
    
    <button type="button" class="bg-gray-50 text-gray-500 text-sm mr-1 menu-soldout-button">\uD488\uC808</button>
    <button type="button" class="bg-gray-50 text-gray-500 text-sm mr-1 menu-edit-button">\uC218\uC815</button>
    <button type="button" class="bg-gray-50 text-gray-500 text-sm menu-remove-button">\uC0AD\uC81C</button>
  </li>`,u=G(n);return V(u,{menuName:e,soldout:t,api:o,stateManager:r})}function z(e,{stateManager:t,api:o}){function r(){for(;e.hasChildNodes();)e.removeChild(e.firstChild)}function n({menuId:a,menuName:l,soldout:c}){const{$container:i}=Y({menuName:l,soldout:c,api:o,stateManager:t});i.dataset.menuId=a,e.insertAdjacentElement("afterbegin",i)}function u(){t.currentCafeItems().forEach(n)}function s(){r(),u()}M(f.CHANGE_CATEGORY,s),M(f.ADD_MENU,n)}function q(e,{stateManager:t}){function o(n){const u=n.target,{categoryName:s}=u.dataset;t.setCurrentCafe(s),g(f.CHANGE_CATEGORY,{categoryName:s})}const r=D(".cafe-category-name");r.forEach(n=>n.addEventListener("click",o)),setTimeout(()=>r[0].click(),50)}function J(e,{stateManager:t}){function o(){const r=t.currentCafeName();e.textContent=`${r} \uBA54\uB274 \uAD00\uB9AC`}M(f.CHANGE_CATEGORY,o)}document.addEventListener("DOMContentLoaded",async()=>{const e=x($()),t=await j({api:e}),o={cafe:t,currentCafe:"espresso"},r=new B(o);new H({cafe:t,stateManager:r,api:e});const n={cafe:t,stateManager:r,api:e};F(N("#espresso-menu-form")),P(N("#espresso-menu-name"),n),z(N("#espresso-menu-list"),n),k(N(".menu-count"),n),q(null,n),J(N(".heading h2"),n)});
